<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<style>
			body {
				background-image: url(images/bg.jpg);
			}
			.mui-bar {
				background: linear-gradient(90deg, #734e31, #db9348, #734e31);
				box-shadow: none;
				color: #fef7ea;
			}
			
			.mui-bar h1 {
				color: #fef7ea;
			}
			
			.mui-bar a {
				color: #fef7ea;
			}
			
			.mui-content {
				background: transparent;
			}
			
			.IconImgs {
				overflow: hidden;
				margin: 0;
				padding: 5px;
			}
			
			.IconImgs img {
				
				width: 100%;
			}
			
			.infoTitles {
				margin: 0;
				text-align: center;
				color: #fff;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}
			
			.title {
				height: 30px;
				line-height: 30px;
				font-size: 18px;
				font-weight: bold;
				padding-left: 15px;
				color: #FFEFDE;
				background: #734e31;
			}
			
				.mui-content-padded {
				margin: 10px 0;
				background: #533523;
			}
			
			.mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active {
				border-bottom: 2px solid #ffe000;
				color: #ffe000;
			}
			
			.mui-segmented-control.mui-segmented-control-inverted .mui-control-item {
				color: #fef7ea;
			}
			
			.mui-popup-buttons .mui-popup-button {
				color: #333333!important;
			}
			#item1,#item2{
				padding-bottom: 30px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav mui-action-back">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">HABA 电子</h1>
		</header>
		<div class="mui-content">
			<p class="title">热门游戏</p>
			<div class="mui-row" id="Slot_Game"></div>
			<p class="title">桌面</p>
			<div class="mui-row" id="Table_Game"></div>
			<p class="title">老虎机</p>
			<div class="mui-row" id="Video_Poker"></div>
		</div>
		<script src="js/mui.min.js"></script>
		<script src="js/app.js"></script>
		<script src="json2.js"></script>
		<script type="text/javascript">
			(function($,doc){
				$.init();
				var obj = {
					gameType: "HABA",
					model: '',
					gameID: ''
				}
				var Slot_Games = Habanero.Slot_Game;
				var Slot_Game = doc.getElementById('Slot_Game');
				var Table_Games = Habanero.Table_Game;
				var Table_Game = doc.getElementById('Table_Game');
				var Video_Pokers = Habanero.Video_Poker;
				var Video_Poker = doc.getElementById('Video_Poker')
				GameHtml(Slot_Games, Slot_Game)
				GameHtml(Table_Games, Table_Game)
				GameHtml(Video_Pokers, Video_Poker);
				$('.mui-row').on('tap', '.box', function(e) {
					obj.gameID = this.getAttribute('data-id');
					GameLink(obj);
				});
			})(mui,document);
			function GameHtml(objs, el) {
				var fragment = document.createDocumentFragment();
				el.innerHTML = '';
				objs.forEach(function(e) {
					var parent = document.createElement('div');
					parent.setAttribute('data-id', e.Keyname)
					parent.className = 'mui-col-sm-4 box mui-col-xs-4';
					var IconImg = document.createElement('p');
					IconImg.className = 'IconImgs';
					var img = document.createElement('img');
					img.setAttribute('src', e.src);
					console.log(e.src)
					var infoTitle = document.createElement('p');
					infoTitle.className = 'infoTitles';
					infoTitle.textContent = e.title;
					IconImg.appendChild(img);
					parent.appendChild(IconImg);
					parent.appendChild(infoTitle);
					fragment.appendChild(parent);
				})
				el.appendChild(fragment);
			}

			function GameLink(objs) {
				plus.nativeUI.showWaiting();
				app.ajax('checklogin.do', {}, function(tokenmsg) {
					if(tokenmsg.msg == "faild") {
						app.check();
					} else if(tokenmsg.msg == "islogin") {
						app.check();
					} else if(tokenmsg.msg == "success") {
						app.setState(tokenmsg);
						app.ajax('User/getToken', {
							userKey: tokenmsg.userkey
						}, function(token) {
							objs.uuid = token.msg;
							app.ajax('User/forwardGame', objs, function(data) {
								plus.nativeUI.closeWaiting();
								if(data.msg == "error") {
									plus.nativeUI.toast('系统错误');
								} else if(data.msg == 'process') {
									plus.nativeUI.toast('维护中');
								} else {
									app.Options.url = data.msg
									app.Options.id = 'EnterGame'
									app.open(app.Options,'HABA电子');
								}
							})
						})
					}
				})
			}
		</script>
	</body>

</html>